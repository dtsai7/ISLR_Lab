---
title: "SL_lab_tree_based_methods"
author: "David Tsai"
date: "3/19/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Decision Trees
```{r}
require(ISLR)
require(tree)
attach(Carseats)

hist(Sales)
High = ifelse(Sales <= 8, "No", "Yes")
Carseats = data.frame(Carseats, High)
```

Fit a tree to these data

Exclude "Sales" from the right-hand side of the formula since the response is derived from it
```{r}
tree.carseats = tree(High ~ . - Sales, data = Carseats)
summary(tree.carseats)
plot(tree.carseats)
text(tree.carseats, pretty = 0)
```

For a detailed summary of the tree, print it:
```{r}
tree.carseats
```

Create a training and test set (250, 150) split of the 400 observations, grow the tree on the training set, and evaluate its performance on the test set
```{r}
set.seed(1011)
train = sample(1:nrow(Carseats), 250)
tree.carseats = tree(High ~ . - Sales, Carseats, subset = train)
plot(tree.carseats)
text(tree.carseats, pretty = 0)

tree.pred = predict(tree.carseats, Carseats[-train,], type = "class")
with(Carseats[-train,], table(tree.pred, High))
```

Use cross-validation to prune the tree.
```{r}
cv.carseats = cv.tree(tree.carseats, FUN = prune.misclass)
cv.carseats
plot(cv.carseats)
prune.carseats = prune.misclass(tree.carseats, best = 13)
plot(prune.carseats)
text(prune.carseats, pretty = 0)
```

Evaluate the pruned tree on the test data.
```{r}
tree.pred = predict(prune.carseats, Carseats[-train,], type = "class")
with(Carseats[-train,], table(tree.pred, High))
```
