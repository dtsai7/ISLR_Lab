---
title: "SL_lab_model_selection"
author: "David Tsai"
date: "3/14/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(ISLR)
summary(Hitters)
```

## remove missing values
There are some missing values, so before proceeding we will remove them
```{r}
Hitters = na.omit(Hitters)
with(Hitters, sum(is.na(Salary)))
```


## Best Subset Selection
Use the package 'leaps' to evaluate all the best subset models.
```{r}
library(leaps)
regfit.full = regsubsets(Salary~., data = Hitters)
summary(regfit.full)
```

Increase best subsets to 19
```{r}
regfit.full = regsubsets(Salary~., data = Hitters, nvmax = 19)
reg.summary = summary(regfit.full)
names(reg.summary)
plot(reg.summary$cp, xlab = "Number of variables", ylab = "Cp")
which.min(reg.summary$cp)
points(10, reg.summary$cp[10], pch = 20, col = "red")
```

A plot method for the regsubset object
```{r}
plot(regfit.full, scale = "Cp")
coef(regfit.full, 10)
```

## Forward Stepwise Selection
Use the 'regsubsets' function but specify the method to forward
```{r}
regfit.fwd = regsubsets(Salary~., data = Hitters, nvmax = 19, method = "forward")
summary(regfit.fwd)
plot(regfit.fwd, scale = "Cp")
```

## Backward Stepwise Selection
Use the 'regsubsets' function but specify the method to backward
```{r}
regfit.bwd = regsubsets(Salary~., data = Hitters, nvmax = 19, method = "backward")
summary(regfit.bwd)
plot(regfit.bwd, scale = "Cp")
```


